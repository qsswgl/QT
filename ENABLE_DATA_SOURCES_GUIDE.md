# ğŸš€ æ•°æ®æºå¯ç”¨å®Œæ•´æŒ‡å—

**æ›´æ–°æ—¶é—´**: 2025-11-25  
**é¢„è®¡å®Œæˆ**: åˆ†é˜¶æ®µé€æ­¥å¯ç”¨  
**éš¾åº¦ç­‰çº§**: â­â­â­ ä¸­é«˜çº§

---

## ğŸ“‹ å¯ç”¨æ¦‚è§ˆ

æœ¬æŒ‡å—å°†æŒ‡å¯¼æ‚¨å¦‚ä½•å°†6ä¸ªå¢å¼ºæ•°æ®æºé›†æˆåˆ°ç°æœ‰ç­–ç•¥ä¸­:

| æ•°æ®æº | å¯ç”¨éš¾åº¦ | é¢„æœŸæ”¶ç›Š | å¯ç”¨ä¼˜å…ˆçº§ | é¢„è®¡æ—¶é—´ |
|--------|----------|----------|------------|----------|
| åŸºæœ¬é¢æ•°æ® | â­â­ ä¸­ç­‰ | ğŸ”¥ğŸ”¥ğŸ”¥ é«˜ | ğŸ”´ ç¬¬ä¸€ä¼˜å…ˆ | 1-2å¤© |
| æ–°é—»æƒ…ç»ª | â­â­ ä¸­ç­‰ | ğŸ”¥ğŸ”¥ ä¸­é«˜ | ğŸ”´ ç¬¬ä¸€ä¼˜å…ˆ | 1-2å¤© |
| å®è§‚ç»æµ | â­â­â­ è¾ƒéš¾ | ğŸ”¥ğŸ”¥ ä¸­é«˜ | ğŸŸ¡ ç¬¬äºŒä¼˜å…ˆ | 2-3å¤© |
| æœŸæƒæ•°æ® | â­â­â­ è¾ƒéš¾ | ğŸ”¥ ä¸­ç­‰ | ğŸŸ¢ ç¬¬ä¸‰ä¼˜å…ˆ | 2-3å¤© |
| ç¤¾äº¤æƒ…ç»ª | â­â­ ä¸­ç­‰ | ğŸ”¥ ä¸­ä½ | ğŸŸ¢ å¯é€‰ | 1-2å¤© |
| å†…éƒ¨äººäº¤æ˜“ | â­â­ ä¸­ç­‰ | ğŸ”¥ ä¸­ä½ | ğŸŸ¢ å¯é€‰ | 1-2å¤© |

---

## ğŸ¯ æ¨èå¯ç”¨è·¯å¾„

### æ–¹æ¡ˆA: ç¨³å¥æ¸è¿›(æ¨è) â­â­â­â­â­

**ç¬¬1é˜¶æ®µ** (ç¬¬1-2å‘¨):
```
ç›®æ ‡: å¢åŠ åŸºæœ¬é¢è¿‡æ»¤,æé«˜é€‰è‚¡è´¨é‡

å¯ç”¨æ•°æ®æº:
âœ… åŸºæœ¬é¢æ•°æ® (FMP)

æ”¹è¿›ç­–ç•¥:
1. ä¹°å…¥ä¿¡å·å¢åŠ è¿‡æ»¤æ¡ä»¶:
   - PE < 40 (ä¼°å€¼åˆç†)
   - ROE > 10% (ç›ˆåˆ©èƒ½åŠ›å¼º)
   - è´¢åŠ¡å¥åº·è¯„åˆ† > 60 (è´¢åŠ¡ç¨³å¥)

2. è´¢æŠ¥å­£é¿é™©:
   - è´¢æŠ¥å‘å¸ƒå‰3å¤©æš‚åœä¹°å…¥
   - è´¢æŠ¥å‘å¸ƒåç­‰å¾…1å¤©å†å†³ç­–

é¢„æœŸæ•ˆæœ:
- è¿‡æ»¤æ‰é«˜ä¼°å€¼è‚¡ç¥¨
- å‡å°‘è´¢æŠ¥"åœ°é›·"
- æé«˜èƒœç‡5-10%
```

**ç¬¬2é˜¶æ®µ** (ç¬¬3-4å‘¨):
```
ç›®æ ‡: å¢åŠ æ–°é—»é£é™©é¢„è­¦

å¯ç”¨æ•°æ®æº:
âœ… æ–°é—»æƒ…ç»ª (NewsAPI + Finnhub)

æ”¹è¿›ç­–ç•¥:
1. é‡å¤§è´Ÿé¢æ–°é—»è¿‡æ»¤:
   - æ–°é—»æƒ…ç»ªå¾—åˆ† < -0.5 â†’ æš‚åœä¹°å…¥
   - æ–°é—»æƒ…ç»ªå¾—åˆ† < -0.7 â†’ è€ƒè™‘å–å‡º

2. æ­£é¢æ–°é—»ç¡®è®¤:
   - ä¹°å…¥ä¿¡å· + æ­£é¢æ–°é—» â†’ å¢å¼ºä¿¡å¿ƒ
   - æ–°é—»æƒ…ç»ªå¾—åˆ† > 0.6 â†’ å¯é€‚åº¦åŠ ä»“

é¢„æœŸæ•ˆæœ:
- é¿å¼€é‡å¤§è´Ÿé¢äº‹ä»¶
- é™ä½é»‘å¤©é¹…é£é™©
- æå‡é£é™©è°ƒæ•´åæ”¶ç›Š
```

**ç¬¬3é˜¶æ®µ** (ç¬¬5-6å‘¨):
```
ç›®æ ‡: é€‚åº”å®è§‚ç»æµç¯å¢ƒ

å¯ç”¨æ•°æ®æº:
âœ… å®è§‚ç»æµæ•°æ® (FRED)

æ”¹è¿›ç­–ç•¥:
1. åˆ©ç‡ç¯å¢ƒè°ƒæ•´:
   - é«˜åˆ©ç‡ç¯å¢ƒ â†’ é™ä½ä»“ä½è‡³40%
   - ä½åˆ©ç‡ç¯å¢ƒ â†’ å¯æé«˜è‡³70%

2. è¡°é€€é¢„è­¦:
   - æ”¶ç›Šç‡æ›²çº¿å€’æŒ‚ â†’ é™ä½ä»“ä½
   - ç»æµå¥åº·è¯„åˆ† < 50 â†’ é˜²å¾¡æ¨¡å¼

é¢„æœŸæ•ˆæœ:
- å®è§‚ç¯å¢ƒé€‚åº”æ€§å¼º
- ç³»ç»Ÿæ€§é£é™©é™ä½
- é•¿æœŸç¨³å®šæ€§æå‡
```

**ç¬¬4é˜¶æ®µ** (ç¬¬7-8å‘¨):
```
ç›®æ ‡: è¡¥å……å¸‚åœºæƒ…ç»ªæŒ‡æ ‡

å¯ç”¨æ•°æ®æº:
âœ… æœŸæƒæ•°æ® (Yahoo Finance)

æ”¹è¿›ç­–ç•¥:
1. æœŸæƒæƒ…ç»ªè¿‡æ»¤:
   - Put/Call > 1.3 â†’ å¸‚åœºè¿‡åº¦çœ‹è·Œ,å¯é€†å‘
   - Put/Call < 0.7 â†’ å¸‚åœºè¿‡åº¦çœ‹æ¶¨,è°¨æ…

2. Max Painå‚è€ƒ:
   - å½“å‰ä»·æ ¼æ¥è¿‘Max Pain â†’ å¯èƒ½æ¨ªç›˜
   - è¿œç¦»Max Pain â†’ è¶‹åŠ¿å¯èƒ½å»¶ç»­

é¢„æœŸæ•ˆæœ:
- å¸‚åœºæƒ…ç»ªæŠŠæ¡
- è¾…åŠ©åˆ¤æ–­è¶‹åŠ¿å¼ºåº¦
```

---

### æ–¹æ¡ˆB: å¿«é€Ÿå…¨é¢(é«˜çº§ç”¨æˆ·)

**ç¬¬1å‘¨**: åŒæ—¶å¯ç”¨åŸºæœ¬é¢+æ–°é—»æƒ…ç»ª
**ç¬¬2å‘¨**: å¯ç”¨å®è§‚ç»æµ
**ç¬¬3å‘¨**: å¯ç”¨æœŸæƒ+ç¤¾äº¤æƒ…ç»ª
**ç¬¬4å‘¨**: å…¨é¢æµ‹è¯•å’Œä¼˜åŒ–

---

## ğŸ“ è¯¦ç»†å¯ç”¨æ­¥éª¤

### 1ï¸âƒ£ å¯ç”¨åŸºæœ¬é¢æ•°æ®

#### æ­¥éª¤1: ä¿®æ”¹ä¿¡å·ç”Ÿæˆé€»è¾‘

**æ–‡ä»¶**: `src/signals/momentum.py`

**å½“å‰ä¹°å…¥ä¿¡å·æ¡ä»¶**:
```python
# åŸæœ‰æ¡ä»¶
if (ma5 > ma20 and 
    current_price > ma5 and 
    volume > avg_volume * 1.3 and
    not has_position):
    # ç”Ÿæˆä¹°å…¥ä¿¡å·
```

**å¢å¼ºåçš„ä¹°å…¥ä¿¡å·æ¡ä»¶**:
```python
# å¢åŠ åŸºæœ¬é¢è¿‡æ»¤
from src.data.fundamentals import FundamentalsDataManager

fundamentals_mgr = FundamentalsDataManager()

# è·å–åŸºæœ¬é¢æ•°æ®
fundamentals = fundamentals_mgr.get_company_overview(symbol)
health = fundamentals_mgr.get_financial_health(symbol)

# åŸºæœ¬é¢è¿‡æ»¤æ¡ä»¶
pe_ratio = fundamentals.get('pe_ratio', 999)
roe = fundamentals.get('roe', 0)
health_score = health.get('score', 0)

# å¢å¼ºçš„ä¹°å…¥æ¡ä»¶
if (ma5 > ma20 and 
    current_price > ma5 and 
    volume > avg_volume * 1.3 and
    not has_position and
    # æ–°å¢åŸºæœ¬é¢æ¡ä»¶
    pe_ratio < 40 and          # ä¼°å€¼åˆç†
    roe > 0.10 and             # ROE > 10%
    health_score > 60):        # è´¢åŠ¡å¥åº·
    # ç”Ÿæˆä¹°å…¥ä¿¡å·
```

#### æ­¥éª¤2: æ·»åŠ è´¢æŠ¥å­£é¿é™©

**åˆ›å»ºæ–‡ä»¶**: `src/utils/earnings_calendar.py`

```python
"""
è´¢æŠ¥å­£é¿é™©å·¥å…·
"""
from datetime import datetime, timedelta
from src.data.fundamentals import FundamentalsDataManager

class EarningsAvoidance:
    """è´¢æŠ¥å­£é¿é™©ç®¡ç†å™¨"""
    
    def __init__(self):
        self.fundamentals_mgr = FundamentalsDataManager()
    
    def is_earnings_period(self, symbol: str, days_before=3, days_after=1):
        """
        æ£€æŸ¥æ˜¯å¦åœ¨è´¢æŠ¥æœŸ
        
        Args:
            symbol: è‚¡ç¥¨ä»£ç 
            days_before: è´¢æŠ¥å‰å‡ å¤©å¼€å§‹é¿é™©
            days_after: è´¢æŠ¥åå‡ å¤©ç»§ç»­é¿é™©
        
        Returns:
            bool: Trueè¡¨ç¤ºåœ¨è´¢æŠ¥æœŸ,åº”é¿é™©
        """
        try:
            # è·å–ä¸‹æ¬¡è´¢æŠ¥æ—¥æœŸ
            calendar = self.fundamentals_mgr.get_earnings_calendar(symbol)
            
            if not calendar or 'next_earnings_date' not in calendar:
                return False
            
            next_earnings = datetime.strptime(
                calendar['next_earnings_date'], 
                '%Y-%m-%d'
            )
            
            today = datetime.now()
            
            # è´¢æŠ¥å‰åæ—¶é—´çª—å£
            start_avoid = next_earnings - timedelta(days=days_before)
            end_avoid = next_earnings + timedelta(days=days_after)
            
            # åˆ¤æ–­æ˜¯å¦åœ¨é¿é™©æœŸ
            in_earnings_period = start_avoid <= today <= end_avoid
            
            if in_earnings_period:
                print(f"âš ï¸  {symbol} è´¢æŠ¥æœŸé¿é™©: è´¢æŠ¥æ—¥æœŸ {next_earnings.date()}")
            
            return in_earnings_period
            
        except Exception as e:
            print(f"æ£€æŸ¥è´¢æŠ¥æœŸå¤±è´¥: {e}")
            return False  # å‡ºé”™æ—¶ä¸é¿é™©
```

#### æ­¥éª¤3: é›†æˆåˆ°æ—¥åº¦ç­–ç•¥

**æ–‡ä»¶**: `src/pipeline/run_daily_check_email.py` (åŠNVDA, INTCç‰ˆæœ¬)

**åœ¨ç”Ÿæˆä¿¡å·å‰æ·»åŠ æ£€æŸ¥**:
```python
from src.utils.earnings_calendar import EarningsAvoidance

earnings_avoidance = EarningsAvoidance()

# æ£€æŸ¥æ˜¯å¦åœ¨è´¢æŠ¥æœŸ
if earnings_avoidance.is_earnings_period(symbol):
    print(f"âš ï¸  {symbol} å½“å‰åœ¨è´¢æŠ¥æœŸ,æš‚åœäº¤æ˜“")
    # ä¸ç”Ÿæˆæ–°ä¿¡å·,ç›´æ¥å‘é€"è´¢æŠ¥æœŸè§‚æœ›"é‚®ä»¶
    email_service.send_daily_summary(
        has_signal=False,
        signal_count=0,
        latest_signal=None,
        error_message="å½“å‰å¤„äºè´¢æŠ¥æœŸ,æš‚åœäº¤æ˜“,ç­‰å¾…è´¢æŠ¥å‘å¸ƒ",
        position_info=position_info,
        symbol=symbol
    )
    return
```

#### æ­¥éª¤4: æµ‹è¯•å’ŒéªŒè¯

```bash
# æµ‹è¯•åŸºæœ¬é¢æ•°æ®è·å–
python -c "from src.data.fundamentals import FundamentalsDataManager; mgr = FundamentalsDataManager(); print(mgr.get_company_overview('NVDA'))"

# æµ‹è¯•è´¢åŠ¡å¥åº·è¯„åˆ†
python -c "from src.data.fundamentals import FundamentalsDataManager; mgr = FundamentalsDataManager(); print(mgr.get_financial_health('NVDA'))"

# æµ‹è¯•å®Œæ•´ç­–ç•¥
.\.venv\Scripts\python.exe src\pipeline\run_daily_check_email.py
```

---

### 2ï¸âƒ£ å¯ç”¨æ–°é—»æƒ…ç»ªæ•°æ®

#### æ­¥éª¤1: åˆ›å»ºæ–°é—»è¿‡æ»¤å™¨

**åˆ›å»ºæ–‡ä»¶**: `src/utils/news_filter.py`

```python
"""
æ–°é—»æƒ…ç»ªè¿‡æ»¤å™¨
"""
from src.data.news_sentiment import NewsDataManager

class NewsFilter:
    """æ–°é—»æƒ…ç»ªè¿‡æ»¤ç®¡ç†å™¨"""
    
    def __init__(self):
        self.news_mgr = NewsDataManager()
    
    def check_sentiment(self, symbol: str, days_back=1):
        """
        æ£€æŸ¥æ–°é—»æƒ…ç»ª
        
        Returns:
            dict: {
                'sentiment': 'positive'/'negative'/'neutral',
                'score': 0.65,
                'recommendation': 'allow'/'caution'/'block',
                'reason': 'è¯´æ˜'
            }
        """
        try:
            # è·å–æ–°é—»æƒ…ç»ª
            summary = self.news_mgr.get_overall_sentiment(symbol, days_back)
            
            if not summary:
                return {
                    'sentiment': 'neutral',
                    'score': 0,
                    'recommendation': 'allow',
                    'reason': 'æ— æ–°é—»æ•°æ®,ä¸å½±å“äº¤æ˜“'
                }
            
            sentiment = summary.get('overall_sentiment', 'neutral')
            score = summary.get('sentiment_score', 0)
            news_count = summary.get('news_count', 0)
            
            # åˆ¤æ–­æ˜¯å¦å½±å“äº¤æ˜“
            if score < -0.7:
                return {
                    'sentiment': sentiment,
                    'score': score,
                    'recommendation': 'block',
                    'reason': f'ä¸¥é‡è´Ÿé¢æ–°é—»({news_count}æ¡),æš‚åœä¹°å…¥'
                }
            elif score < -0.5:
                return {
                    'sentiment': sentiment,
                    'score': score,
                    'recommendation': 'caution',
                    'reason': f'è´Ÿé¢æ–°é—»è¾ƒå¤š({news_count}æ¡),è°¨æ…äº¤æ˜“'
                }
            elif score > 0.6:
                return {
                    'sentiment': sentiment,
                    'score': score,
                    'recommendation': 'encourage',
                    'reason': f'æ­£é¢æ–°é—»({news_count}æ¡),æ”¯æŒä¹°å…¥'
                }
            else:
                return {
                    'sentiment': sentiment,
                    'score': score,
                    'recommendation': 'allow',
                    'reason': f'æ–°é—»æƒ…ç»ªä¸­æ€§({news_count}æ¡)'
                }
                
        except Exception as e:
            print(f"æ–°é—»æƒ…ç»ªæ£€æŸ¥å¤±è´¥: {e}")
            return {
                'sentiment': 'neutral',
                'score': 0,
                'recommendation': 'allow',
                'reason': 'æ–°é—»æ•°æ®è·å–å¤±è´¥,ä¸å½±å“äº¤æ˜“'
            }
```

#### æ­¥éª¤2: é›†æˆåˆ°ç­–ç•¥

**æ–‡ä»¶**: `src/pipeline/run_daily_check_email.py`

```python
from src.utils.news_filter import NewsFilter

news_filter = NewsFilter()

# åœ¨ç”Ÿæˆä¹°å…¥ä¿¡å·å‰æ£€æŸ¥æ–°é—»
if signal_action == 'BUY':
    news_check = news_filter.check_sentiment(symbol)
    
    print(f"ğŸ“° æ–°é—»æƒ…ç»ª: {news_check['sentiment']}")
    print(f"   å¾—åˆ†: {news_check['score']:.2f}")
    print(f"   å»ºè®®: {news_check['recommendation']}")
    print(f"   åŸå› : {news_check['reason']}")
    
    # æ ¹æ®æ–°é—»æƒ…ç»ªå†³å®šæ˜¯å¦æ‰§è¡Œä¹°å…¥
    if news_check['recommendation'] == 'block':
        print("âš ï¸  å› è´Ÿé¢æ–°é—»è¿‡å¤š,å–æ¶ˆä¹°å…¥ä¿¡å·")
        # ä¸ç”Ÿæˆä¹°å…¥ä¿¡å·
        continue
    
    elif news_check['recommendation'] == 'caution':
        print("âš ï¸  æœ‰è´Ÿé¢æ–°é—»,é™ä½ä¹°å…¥æ•°é‡50%")
        # å‡å°‘ä¹°å…¥æ•°é‡
        quantity = quantity // 2
```

---

### 3ï¸âƒ£ å¯ç”¨å®è§‚ç»æµæ•°æ®

#### æ­¥éª¤1: åˆ›å»ºå®è§‚ç¯å¢ƒç®¡ç†å™¨

**åˆ›å»ºæ–‡ä»¶**: `src/utils/macro_environment.py`

```python
"""
å®è§‚ç»æµç¯å¢ƒç®¡ç†å™¨
"""
from src.data.macro_data import MacroDataManager

class MacroEnvironment:
    """å®è§‚ç»æµç¯å¢ƒç®¡ç†å™¨"""
    
    def __init__(self):
        self.macro_mgr = MacroDataManager()
    
    def get_position_adjustment(self):
        """
        æ ¹æ®å®è§‚ç¯å¢ƒå»ºè®®ä»“ä½è°ƒæ•´
        
        Returns:
            dict: {
                'position_multiplier': 0.6,  # ä»“ä½ä¹˜æ•°
                'environment': 'restrictive',
                'reason': 'è¯´æ˜'
            }
        """
        try:
            health = self.macro_mgr.get_economic_health()
            
            if not health:
                return {
                    'position_multiplier': 1.0,
                    'environment': 'unknown',
                    'reason': 'æ— å®è§‚æ•°æ®,ä½¿ç”¨é»˜è®¤ä»“ä½'
                }
            
            score = health.get('score', 50)
            recession_risk = health.get('recession_risk', 'moderate')
            warnings = health.get('warnings', [])
            
            # æ ¹æ®ç»æµå¥åº·åº¦è°ƒæ•´ä»“ä½
            if score >= 70:
                return {
                    'position_multiplier': 1.0,
                    'environment': 'healthy',
                    'reason': 'ç»æµç¯å¢ƒå¥åº·,æ­£å¸¸ä»“ä½'
                }
            elif score >= 50:
                return {
                    'position_multiplier': 0.8,
                    'environment': 'moderate',
                    'reason': 'ç»æµç¯å¢ƒä¸€èˆ¬,é€‚åº¦é™ä½ä»“ä½'
                }
            else:
                return {
                    'position_multiplier': 0.6,
                    'environment': 'weak',
                    'reason': 'ç»æµç¯å¢ƒè¾ƒå·®,é™ä½ä»“ä½è‡³60%'
                }
                
        except Exception as e:
            print(f"å®è§‚ç¯å¢ƒæ£€æŸ¥å¤±è´¥: {e}")
            return {
                'position_multiplier': 1.0,
                'environment': 'unknown',
                'reason': 'å®è§‚æ•°æ®è·å–å¤±è´¥,ä½¿ç”¨é»˜è®¤ä»“ä½'
            }
```

#### æ­¥éª¤2: åŠ¨æ€è°ƒæ•´ä»“ä½

```python
from src.utils.macro_environment import MacroEnvironment

macro_env = MacroEnvironment()

# è·å–å®è§‚ç¯å¢ƒå»ºè®®
env_adjustment = macro_env.get_position_adjustment()

print(f"ğŸŒ å®è§‚ç¯å¢ƒ: {env_adjustment['environment']}")
print(f"   ä»“ä½è°ƒæ•´: {env_adjustment['position_multiplier']*100:.0f}%")
print(f"   åŸå› : {env_adjustment['reason']}")

# è°ƒæ•´ä¹°å…¥æ•°é‡
if signal_action == 'BUY':
    # åº”ç”¨å®è§‚ç¯å¢ƒè°ƒæ•´
    quantity = int(quantity * env_adjustment['position_multiplier'])
    print(f"   è°ƒæ•´åæ•°é‡: {quantity}è‚¡")
```

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### å•å…ƒæµ‹è¯•

åˆ›å»º `tests/test_enhanced_strategy.py`:

```python
"""
å¢å¼ºç­–ç•¥æµ‹è¯•
"""
import unittest
from src.utils.earnings_calendar import EarningsAvoidance
from src.utils.news_filter import NewsFilter
from src.utils.macro_environment import MacroEnvironment

class TestEnhancedStrategy(unittest.TestCase):
    """å¢å¼ºç­–ç•¥æµ‹è¯•ç±»"""
    
    def test_earnings_avoidance(self):
        """æµ‹è¯•è´¢æŠ¥é¿é™©"""
        ea = EarningsAvoidance()
        result = ea.is_earnings_period('NVDA')
        self.assertIsInstance(result, bool)
    
    def test_news_filter(self):
        """æµ‹è¯•æ–°é—»è¿‡æ»¤"""
        nf = NewsFilter()
        result = nf.check_sentiment('TSLA')
        self.assertIn('sentiment', result)
        self.assertIn('recommendation', result)
    
    def test_macro_environment(self):
        """æµ‹è¯•å®è§‚ç¯å¢ƒ"""
        me = MacroEnvironment()
        result = me.get_position_adjustment()
        self.assertIn('position_multiplier', result)
        self.assertGreater(result['position_multiplier'], 0)

if __name__ == '__main__':
    unittest.main()
```

**è¿è¡Œæµ‹è¯•**:
```bash
python -m pytest tests/test_enhanced_strategy.py -v
```

---

## ğŸ“Š å›æµ‹å¯¹æ¯”

### å¯ç”¨å‰ vs å¯ç”¨å

**åˆ›å»ºå›æµ‹å¯¹æ¯”è„šæœ¬**: `compare_strategies.py`

```python
"""
å¯¹æ¯”åŸå§‹ç­–ç•¥ vs å¢å¼ºç­–ç•¥
"""
# åŸå§‹ç­–ç•¥å›æµ‹
original_results = run_backtest_original()

# å¢å¼ºç­–ç•¥å›æµ‹(åŸºæœ¬é¢+æ–°é—»+å®è§‚)
enhanced_results = run_backtest_enhanced()

# å¯¹æ¯”æŒ‡æ ‡
print("ç­–ç•¥å¯¹æ¯”:")
print(f"åŸå§‹ç­–ç•¥ - å¹´åŒ–æ”¶ç›Š: {original_results['annual_return']:.2%}")
print(f"å¢å¼ºç­–ç•¥ - å¹´åŒ–æ”¶ç›Š: {enhanced_results['annual_return']:.2%}")
print(f"æ”¹è¿›å¹…åº¦: {(enhanced_results['annual_return'] - original_results['annual_return']):.2%}")

print(f"\nåŸå§‹ç­–ç•¥ - æœ€å¤§å›æ’¤: {original_results['max_drawdown']:.2%}")
print(f"å¢å¼ºç­–ç•¥ - æœ€å¤§å›æ’¤: {enhanced_results['max_drawdown']:.2%}")

print(f"\nåŸå§‹ç­–ç•¥ - èƒœç‡: {original_results['win_rate']:.2%}")
print(f"å¢å¼ºç­–ç•¥ - èƒœç‡: {enhanced_results['win_rate']:.2%}")
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### APIè¯·æ±‚é™åˆ¶

1. **æ§åˆ¶è¯·æ±‚é¢‘ç‡**:
```python
import time

# é¿å…çŸ­æ—¶é—´å¤§é‡è¯·æ±‚
time.sleep(1)  # è¯·æ±‚é—´éš”1ç§’
```

2. **ä½¿ç”¨ç¼“å­˜æœºåˆ¶**:
```python
from functools import lru_cache
from datetime import datetime, timedelta

@lru_cache(maxsize=100)
def get_fundamentals_cached(symbol, date):
    """å¸¦ç¼“å­˜çš„åŸºæœ¬é¢æ•°æ®"""
    return get_fundamentals(symbol)

# æ¯å¤©åªè¯·æ±‚ä¸€æ¬¡
cache_key = f"{symbol}_{datetime.now().date()}"
```

3. **ç›‘æ§é…é¢ä½¿ç”¨**:
```python
# è®°å½•APIè°ƒç”¨æ¬¡æ•°
api_calls = {
    'alpha_vantage': 0,
    'fmp': 0,
    'newsapi': 0
}

def track_api_call(source):
    api_calls[source] += 1
    if api_calls[source] % 100 == 0:
        print(f"âš ï¸  {source} å·²è°ƒç”¨ {api_calls[source]} æ¬¡")
```

---

## ğŸ“… å®æ–½è®¡åˆ’

### å»ºè®®æ—¶é—´è¡¨

**ç¬¬1å‘¨**:
- âœ… ç”³è¯·æ‰€æœ‰APIå¯†é’¥
- âœ… è¿è¡Œ `setup_api_keys.py` é…ç½®
- âœ… è¿è¡Œ `test_all_data_sources.py` æµ‹è¯•
- âœ… ç†Ÿæ‚‰å„æ•°æ®æºAPI

**ç¬¬2å‘¨**:
- âœ… å¯ç”¨åŸºæœ¬é¢æ•°æ®
- âœ… æµ‹è¯•è´¢æŠ¥é¿é™©é€»è¾‘
- âœ… å›æµ‹éªŒè¯æ•ˆæœ

**ç¬¬3å‘¨**:
- âœ… å¯ç”¨æ–°é—»æƒ…ç»ª
- âœ… æµ‹è¯•æ–°é—»è¿‡æ»¤é€»è¾‘
- âœ… è§‚å¯Ÿå®ç›˜æ•ˆæœ

**ç¬¬4å‘¨**:
- âœ… å¯ç”¨å®è§‚ç»æµ
- âœ… åŠ¨æ€ä»“ä½è°ƒæ•´
- âœ… å…¨é¢æµ‹è¯•

**ç¬¬5å‘¨åŠä»¥å**:
- âœ… æŒç»­ä¼˜åŒ–å‚æ•°
- âœ… ç›‘æ§ç­–ç•¥è¡¨ç°
- âœ… æ ¹æ®å¸‚åœºè°ƒæ•´

---

## ğŸ†˜ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

**Q1: APIè¯·æ±‚å¤±è´¥?**
```python
# æ·»åŠ é‡è¯•æœºåˆ¶
from tenacity import retry, stop_after_attempt, wait_fixed

@retry(stop=stop_after_attempt(3), wait=wait_fixed(2))
def get_data_with_retry(symbol):
    return get_data(symbol)
```

**Q2: æ•°æ®æ ¼å¼ä¸å¯¹?**
```python
# æ·»åŠ æ•°æ®éªŒè¯
def validate_data(data):
    required_fields = ['pe_ratio', 'roe', 'market_cap']
    for field in required_fields:
        if field not in data:
            raise ValueError(f"ç¼ºå°‘å­—æ®µ: {field}")
    return data
```

**Q3: æ€§èƒ½å˜æ…¢?**
```python
# ä½¿ç”¨å¼‚æ­¥è¯·æ±‚
import asyncio
import aiohttp

async def get_multiple_data(symbols):
    tasks = [fetch_data_async(s) for s in symbols]
    return await asyncio.gather(*tasks)
```

---

## ğŸ“ å®Œæˆæ£€æŸ¥æ¸…å•

### æ•°æ®æºé…ç½®
- [ ] æ‰€æœ‰APIå¯†é’¥å·²ç”³è¯·
- [ ] .envæ–‡ä»¶å·²é…ç½®
- [ ] æµ‹è¯•è„šæœ¬å…¨éƒ¨é€šè¿‡

### ä»£ç é›†æˆ
- [ ] åŸºæœ¬é¢è¿‡æ»¤å·²æ·»åŠ 
- [ ] æ–°é—»æƒ…ç»ªè¿‡æ»¤å·²æ·»åŠ 
- [ ] å®è§‚ç¯å¢ƒè°ƒæ•´å·²æ·»åŠ 
- [ ] å•å…ƒæµ‹è¯•å·²é€šè¿‡

### å›æµ‹éªŒè¯
- [ ] å¢å¼ºç­–ç•¥å›æµ‹å®Œæˆ
- [ ] å¯¹æ¯”åŸç­–ç•¥æœ‰æ”¹è¿›
- [ ] å‚æ•°å·²ä¼˜åŒ–

### å®ç›˜å‡†å¤‡
- [ ] æ—¥åº¦ç­–ç•¥å·²æ›´æ–°
- [ ] é‚®ä»¶é€šçŸ¥å·²å¢å¼º
- [ ] ç›‘æ§ç³»ç»Ÿå·²éƒ¨ç½²

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-11-25  
**çŠ¶æ€**: âœ… å®Œæ•´æŒ‡å—  
**ä¸‹ä¸€æ­¥**: å¼€å§‹å¯ç”¨ç¬¬ä¸€ä¸ªæ•°æ®æº(åŸºæœ¬é¢)

ğŸš€ **å‡†å¤‡å¥½äº†å—?** è®©æˆ‘ä»¬å¼€å§‹å¢å¼ºæ‚¨çš„ç­–ç•¥!
