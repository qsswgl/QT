# 📋 Firstrade 手动交易执行指南

## 🎯 适用场景

我们的**改进策略**特点:
- ✅ 交易频率极低 (回测15年仅1笔交易)
- ✅ 长期持有为主
- ✅ 不需要精确到秒的执行
- ✅ **完全适合手动操作**

---

## 📊 每周执行流程

### 步骤 1: 更新数据 (每周一次)

```bash
# 在项目目录运行
k:/QT/.venv/Scripts/python.exe -m src.pipeline.update_data TSLA --start 2010-06-29
```

**时间**: 每周末或周一早上
**耗时**: 约30秒

---

### 步骤 2: 运行策略 (生成最新信号)

```bash
k:/QT/.venv/Scripts/python.exe -m src.pipeline.run_improved_strategy
```

**输出位置**: `backtest_results/improved/signals_improved.csv`

**检查内容**:
- 是否有新的交易信号?
- 最新信号的日期是今天吗?
- 建议的买入/卖出数量是多少?

---

### 步骤 3: 查看信号详情

打开生成的信号文件:
```
backtest_results/improved/signals_improved.csv
```

**文件格式**:
```csv
date,action,quantity,reason
2012-01-13,BUY,2076,趋势确认 + 强势突破信号
2025-XX-XX,SELL,2076,动量减弱信号
```

**关键信息**:
- `date`: 信号日期
- `action`: BUY(买入) / SELL(卖出)
- `quantity`: 建议股数
- `reason`: 信号原因

---

### 步骤 4: 在 Firstrade 执行交易

#### 🟢 如果是 BUY 信号

1. **登录 Firstrade**
   - 网址: https://www.firstrade.com
   - 使用你的账号密码登录

2. **进入交易页面**
   - 点击 "Trade" → "Stocks & Options"

3. **填写订单信息**
   ```
   Symbol:        TSLA
   Action:        Buy
   Quantity:      [CSV文件中的quantity]
   Order Type:    Market (市价单) 或 Limit (限价单)
   Duration:      Day (当日有效)
   ```

4. **选择订单类型**
   
   **市价单 (Market Order)** - 推荐
   - ✅ 立即成交
   - ✅ 简单快速
   - ⚠️ 价格可能略有滑点
   - **适合**: 流动性好的股票(如TSLA)
   
   **限价单 (Limit Order)**
   - ✅ 价格可控
   - ⚠️ 可能不成交
   - **设置**: 当前价格 ± 0.5%
   - **适合**: 想要更精确控制价格

5. **确认并提交**
   - 仔细检查数量和方向
   - 确认后提交订单
   - 记录订单号

---

#### 🔴 如果是 SELL 信号

流程与BUY相同,只是:
```
Action: Sell
Quantity: [CSV文件中的quantity]
```

**注意**: 
- 确保你有足够的持仓
- 卖出数量不能超过持仓数量

---

### 步骤 5: 记录交易 (建议)

创建一个交易日志,记录:
```
日期: 2025-11-11
信号: BUY TSLA 2076股
执行价格: $250.50
实际数量: 2076股
总成本: $520,038
佣金: $0 (Firstrade免佣)
订单号: #12345678
备注: 趋势确认信号
```

**好处**:
- 便于日后回顾
- 对比策略信号与实际执行
- 税务申报时有据可查

---

## 🔔 信号提醒设置

### 方案 A: 邮件提醒 (简单)

我可以帮你添加邮件提醒功能:

```python
# 当有新信号时,自动发邮件给你
# 内容包括: 股票代码、动作、数量、原因
```

### 方案 B: 手机推送 (高级)

使用第三方服务(如Pushover, Telegram):
```python
# 信号直接推送到手机
# 可以随时随地收到通知
```

**需要的话告诉我,我帮你实现! 📱**

---

## 📈 监控频率建议

### 根据策略特点

我们的改进策略:
- 趋势跟踪为主
- 交易频率极低
- 不需要日内监控

### 推荐频率

| 频率 | 适用场景 | 说明 |
|:-----|:--------|:-----|
| **每周一次** ⭐ | **推荐** | 周末更新数据,周一检查信号 |
| 每月一次 | 最低要求 | 适合极度懒人 😄 |
| 每天一次 | 过度谨慎 | 不必要,浪费时间 |

---

## ⚠️ 重要注意事项

### 1. 市场时间
```
美股交易时间 (EST):
- 正常交易: 9:30 AM - 4:00 PM
- 盘前交易: 8:00 AM - 9:30 AM (可选)
- 盘后交易: 4:00 PM - 8:00 PM (可选)
```

**建议**: 在正常交易时间执行

---

### 2. 资金准备

**买入前确认**:
- ✅ 账户有足够现金
- ✅ 考虑3-5%的价格波动缓冲
- ✅ 预留一些现金应急

**示例**:
```
信号建议买入: 2076股 × $250 = $519,000
建议准备: $519,000 × 1.05 = $545,000
```

---

### 3. 持仓管理

**买入后**:
- 记录成本价
- 设置目标(可选)
- 不要频繁查看账户(避免情绪波动)

**卖出前**:
- 确认持仓数量
- 考虑税务影响(长期资本利得 vs 短期)
- 美国长期持仓(>1年)税率更低

---

### 4. 异常情况处理

#### 情况A: 价格大幅波动

**信号当天TSLA涨跌超过5%**

**处理**:
- 市价单: 直接执行(接受当前价格)
- 限价单: 设置更宽的限价范围
- 或等待价格稳定后执行

#### 情况B: 系统故障

**Firstrade网站无法访问**

**处理**:
- 使用Firstrade手机APP
- 或拨打客服电话: 1-800-869-8800
- 或等待系统恢复(低频策略不急)

#### 情况C: 信号延迟

**周末生成信号,周一执行**

**处理**:
- 这是正常的
- 开盘后尽快执行
- 价格差异在可接受范围内

---

## 📊 执行效果监控

### 每月回顾

**对比项目**:
1. 策略建议价格 vs 实际成交价格
2. 建议数量 vs 实际数量
3. 信号日期 vs 执行日期

**容忍范围**:
```
价格偏差: ±2% 可接受
时间延迟: 1-2个交易日 可接受
数量偏差: 尽量精确
```

---

## 🎯 快速检查清单

### 交易前检查 ✅

```
□ 数据已更新到最新
□ 策略已运行,信号已生成
□ 确认信号日期是最近的
□ 账户资金充足
□ 确认交易方向(买/卖)
□ 确认交易数量
□ 市场在交易时间内
```

### 交易后记录 ✅

```
□ 记录订单号
□ 记录实际成交价
□ 记录实际成交量
□ 更新持仓记录
□ 保存交易确认单
```

---

## 💡 实战技巧

### 技巧 1: 批处理执行

如果策略建议买入大量股票(如2000+股):

**选项A**: 一次性全部买入
- ✅ 简单快速
- ⚠️ 价格风险集中

**选项B**: 分2-3次买入
- ✅ 降低价格风险
- ✅ 平均成本
- ⚠️ 稍微复杂

**我们的策略**: 建议选项A (因为是长期持有)

---

### 技巧 2: 价格确认

在执行前查看当前价格:

**工具**:
- Yahoo Finance: https://finance.yahoo.com/quote/TSLA
- Google Finance: google.com/finance/quote/TSLA:NASDAQ
- Firstrade实时报价

**判断**:
```
如果价格与策略信号时相差:
< 2%: 正常,直接执行
2-5%: 可接受,考虑限价单
> 5%: 重新评估,可能需要等待
```

---

### 技巧 3: 记录保存

**必须保存的文档**:
1. 每次生成的信号CSV文件
2. Firstrade交易确认单
3. 个人交易日志

**文件命名建议**:
```
signals_2025_11_11.csv
confirmation_2025_11_11_TSLA_BUY.pdf
trade_log_2025.xlsx
```

---

## 🚀 高级优化(可选)

### 1. 自动化监控脚本

创建一个Windows计划任务,每周自动运行:

```batch
@echo off
cd K:\QT
k:/QT/.venv/Scripts/python.exe -m src.pipeline.update_data TSLA --start 2010-06-29
k:/QT/.venv/Scripts/python.exe -m src.pipeline.run_improved_strategy
echo 策略已更新,请查看 backtest_results/improved/signals_improved.csv
pause
```

保存为 `weekly_check.bat`,设置Windows计划任务每周六运行。

---

### 2. 信号变化检测

我可以帮你写一个脚本,对比上次和本次的信号:

```python
# 只在有新信号时提醒你
# 避免每次都要手动查看
```

需要的话告诉我! 🔔

---

## 📞 常见问题

### Q1: 如果我错过了信号日期怎么办?

**A**: 
- 低频策略,1-2天延迟影响很小
- 可以继续执行(除非价格变化超过5%)
- 记录实际执行日期和价格

---

### Q2: 如果策略信号和市场新闻矛盾?

**A**:
- 策略基于历史数据和技术分析
- 基本面突发事件策略无法预知
- 建议: 重大负面新闻时可以暂缓执行
- 长期策略不应被短期新闻干扰

---

### Q3: 我可以修改策略建议的数量吗?

**A**:
- 可以,这是你的账户
- 建议: 保持比例一致
- 例如: 策略建议2000股,你只想买1000股,可以减半
- 但不要偏离太多,否则影响策略效果

---

### Q4: 策略多久会生成一次信号?

**A**:
- 根据回测: 15年仅1次买入信号
- 实际可能更频繁(因为实时数据)
- 预计: 1-2年一次交易信号
- 所以不需要每天检查

---

## ✅ 总结

### 你需要做的 (非常简单!)

1. **每周**: 运行2个命令(5分钟)
2. **检查**: 是否有新信号(1分钟)
3. **执行**: 如有信号,在Firstrade下单(5分钟)
4. **记录**: 保存交易记录(2分钟)

**总计**: 每周不到15分钟,每年可能只需要实际交易1-2次!

---

### 优势

✅ **简单**: 不需要API,不需要编程
✅ **可靠**: 不依赖第三方服务
✅ **安全**: 不需要共享密码
✅ **灵活**: 可以人工判断特殊情况
✅ **适合**: 低频长期策略

---

## 🎁 额外工具

我可以为你创建:

**1. 信号提醒脚本** - 有新信号时发邮件/短信
**2. 执行检查清单** - 打印版,贴在电脑旁
**3. 交易日志模板** - Excel表格,方便记录
**4. 自动监控脚本** - Windows计划任务

**需要的话告诉我! 我立即帮你实现! 🚀**

---

**准备好了吗? 从下周开始执行! 💪**
