# ğŸ“§ é‚®ä»¶ç³»ç»Ÿé—®é¢˜å®Œæ•´æŠ¥å‘Š

## ğŸ“‹ é—®é¢˜æ€»ç»“

**é—®é¢˜**: TSLA/NVDA/INTC ç­–ç•¥æ‰§è¡Œåæ— æ³•æ”¶åˆ°é‚®ä»¶é€šçŸ¥

**é”™è¯¯ä¿¡æ¯**:
```
âŒ [WinError 10060] ç”±äºè¿æ¥æ–¹åœ¨ä¸€æ®µæ—¶é—´åæ²¡æœ‰æ­£ç¡®ç­”å¤æˆ–è¿æ¥çš„ä¸»æœºæ²¡æœ‰ååº”ï¼Œè¿æ¥å°è¯•å¤±è´¥ã€‚
```

---

## ğŸ” é—®é¢˜åˆ†æ

### æµ‹è¯•ç»“æœå¯¹æ¯”

| æµ‹è¯•é¡¹ | ç¬¬1æ¬¡æµ‹è¯• | ç¬¬2æ¬¡æµ‹è¯• | TSLAç­–ç•¥ |
|--------|----------|----------|----------|
| DNSè§£æ | âœ… æˆåŠŸ | âœ… æˆåŠŸ | âœ… æˆåŠŸ |
| ç«¯å£587è¿æ¥ | âœ… æˆåŠŸ | âœ… æˆåŠŸ | âœ… æˆåŠŸ |
| TLSæ¡æ‰‹ | âœ… æˆåŠŸ | âœ… æˆåŠŸ | âœ… æˆåŠŸ |
| SMTPç™»å½• | âœ… æˆåŠŸ | âŒ è¶…æ—¶ | âŒ è¶…æ—¶ |
| å‘é€é‚®ä»¶ | âœ… æˆåŠŸ | - | - |
| ç”¨æˆ·æ”¶åˆ° | âœ… å·²æ”¶åˆ° | - | - |

### ç»“è®º

**è¿™æ˜¯ç½‘ç»œç¨³å®šæ€§é—®é¢˜ï¼Œä¸æ˜¯ä»£ç é—®é¢˜**ï¼š

1. **é—´æ­‡æ€§è¿æ¥æˆåŠŸ**: ç¬¬1æ¬¡æµ‹è¯•å®Œå…¨æˆåŠŸï¼Œè¯æ˜ä»£ç å’Œé…ç½®éƒ½æ­£ç¡®
2. **é—´æ­‡æ€§è¿æ¥è¶…æ—¶**: ç¬¬2æ¬¡æµ‹è¯•å’Œç­–ç•¥æ‰§è¡Œæ—¶ç™»å½•è¶…æ—¶
3. **è¶…æ—¶ä½ç½®**: åœ¨TLSåŠ å¯†åçš„SMTPç™»å½•é˜¶æ®µè¶…æ—¶
4. **ç½‘ç»œå±‚é¢æ­£å¸¸**: DNSå’ŒTCPè¿æ¥éƒ½æ­£å¸¸ï¼Œè¯´æ˜åŸºç¡€ç½‘ç»œå¯è¾¾
5. **TLSå±‚é¢é—®é¢˜**: TLSæ¡æ‰‹æˆåŠŸä½†åç»­æ•°æ®ä¼ è¾“è¶…æ—¶

---

## ğŸ› ï¸ å·²å®æ–½çš„ä¿®å¤

### 1. å¢å¼ºè¶…æ—¶å¤„ç† âœ…

ä¿®æ”¹äº† `src/notification/email_service.py` çš„ `_send_email()` æ–¹æ³•ï¼š

```python
# å…³é”®æ”¹è¿›
timeout = 60  # SMTPè¶…æ—¶ä»é»˜è®¤(5-10ç§’)å¢åŠ åˆ°60ç§’
max_retries = 3  # å¤±è´¥åè‡ªåŠ¨é‡è¯•3æ¬¡
retry_delay = 5  # æ¯æ¬¡é‡è¯•é—´éš”5ç§’

# ä¸“é—¨æ•è·ç½‘ç»œè¶…æ—¶é”™è¯¯
except (socket.timeout, TimeoutError, OSError) as e:
    print(f"âš ï¸ ç½‘ç»œè¶…æ—¶ (å°è¯• {attempt + 1}/{max_retries}): {e}")
    if attempt == max_retries - 1:
        print(f"âŒ é‚®ä»¶å‘é€å¤±è´¥: å·²å°è¯• {max_retries} æ¬¡ï¼Œä»ç„¶è¶…æ—¶")
        return False
```

### 2. æ·»åŠ å¿…è¦çš„å¯¼å…¥ âœ…

```python
import socket  # ç”¨äºæ•è·socket.timeoutå¼‚å¸¸
import time    # ç”¨äºé‡è¯•å»¶è¿Ÿ
```

---

## ğŸš¨ æ ¹æœ¬åŸå› 

**å›½å†…ç½‘ç»œè®¿é—®Gmail SMTPçš„é™åˆ¶**:

1. **GFWå¹²æ‰°**: GmailæœåŠ¡åœ¨å›½å†…è®¿é—®å—é™
2. **TLSæ·±åº¦æ£€æµ‹**: è¿è¥å•†å¯èƒ½æ£€æµ‹å’Œé™åˆ¶TLSåŠ å¯†æµé‡
3. **é«˜å»¶è¿Ÿ**: å›½å†…åˆ°GmailæœåŠ¡å™¨å»¶è¿Ÿé«˜ï¼Œå®¹æ˜“è¶…æ—¶
4. **é—´æ­‡æ€§é˜»æ–­**: ä¸æ˜¯å®Œå…¨å°é”ï¼Œä½†è¿æ¥ä¸ç¨³å®š

è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆï¼š
- æœ‰æ—¶èƒ½è¿ä¸Šï¼ˆç¬¬1æ¬¡æµ‹è¯•æˆåŠŸï¼‰
- æœ‰æ—¶è¿ä¸ä¸Šï¼ˆç¬¬2æ¬¡æµ‹è¯•å¤±è´¥ï¼‰
- TCPè¿æ¥æ­£å¸¸ä½†TLSæ•°æ®ä¼ è¾“è¶…æ—¶

---

## ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰

### â­ æ–¹æ¡ˆ1: ä½¿ç”¨å›½å†…é‚®ç®±æœåŠ¡ï¼ˆæ¨èï¼‰

**æœ€ç¨³å®šçš„æ–¹æ¡ˆ**ï¼Œå®Œå…¨è§„é¿Gmailè¿æ¥é—®é¢˜ã€‚

#### é€‰é¡¹A: QQé‚®ç®±

1. **å¼€å¯SMTPæœåŠ¡**:
   - ç™»å½• https://mail.qq.com
   - è®¾ç½® â†’ è´¦æˆ· â†’ POP3/SMTPæœåŠ¡ â†’ å¼€å¯
   - ç”Ÿæˆæˆæƒç 

2. **ä¿®æ”¹é…ç½®** (`src/notification/email_config.py`):
   ```python
   sender_email: str = "ä½ çš„QQå·@qq.com"
   sender_password: str = "QQé‚®ç®±æˆæƒç "  # ä¸æ˜¯QQå¯†ç !
   recipient_email: str = "qsswgl@gmail.com"  # å¯ä»¥å‘åˆ°Gmail
   smtp_server: str = "smtp.qq.com"
   smtp_port: int = 587
   use_tls: bool = True
   use_ssl: bool = False
   ```

#### é€‰é¡¹B: 163é‚®ç®±

1. **å¼€å¯SMTPæœåŠ¡**:
   - ç™»å½• https://mail.163.com
   - è®¾ç½® â†’ POP3/SMTP/IMAP â†’ å¼€å¯
   - è®¾ç½®æˆæƒå¯†ç 

2. **ä¿®æ”¹é…ç½®**:
   ```python
   sender_email: str = "ä½ çš„é‚®ç®±@163.com"
   sender_password: str = "163æˆæƒå¯†ç "
   recipient_email: str = "qsswgl@gmail.com"
   smtp_server: str = "smtp.163.com"
   smtp_port: int = 465
   use_tls: bool = False
   use_ssl: bool = True
   ```

---

### â­ æ–¹æ¡ˆ2: ä½¿ç”¨VPN/ä»£ç†

å¦‚æœå¿…é¡»ä½¿ç”¨Gmailï¼Œéœ€è¦ç¨³å®šçš„VPNã€‚

```powershell
# åœ¨è¿è¡Œç­–ç•¥å‰è®¾ç½®ä»£ç†
$env:HTTP_PROXY = "http://127.0.0.1:7890"
$env:HTTPS_PROXY = "http://127.0.0.1:7890"

# è¿è¡Œç­–ç•¥
.\daily_strategy_check.bat
```

**æ³¨æ„**: 
- éœ€è¦VPNæ”¯æŒä»£ç†æ¨¡å¼
- ä»£ç†ç«¯å£æ ¹æ®ä½ çš„VPNè½¯ä»¶è°ƒæ•´

---

### æ–¹æ¡ˆ3: é€‰æ‹©ç½‘ç»œç¨³å®šæ—¶æ®µæ‰§è¡Œ

å¦‚æœå‘ç°æŸäº›æ—¶æ®µè¿æ¥æˆåŠŸç‡é«˜ï¼š

```bat
REM åˆ›å»º delayed_strategy_check.bat
@echo off
echo ç­‰å¾…åˆ°å‡Œæ™¨æ‰§è¡Œï¼ˆç½‘ç»œè¾ƒç¨³å®šï¼‰...
timeout /t 7200 >nul
.\daily_strategy_check.bat
```

---

### æ–¹æ¡ˆ4: ä½¿ç”¨æ›¿ä»£é€šçŸ¥æ–¹å¼

#### é€‰é¡¹A: å¾®ä¿¡æ¨é€ï¼ˆé€šè¿‡Serveré…±ï¼‰

1. æ³¨å†Œ https://sct.ftqq.com/
2. è·å–SendKey
3. æ·»åŠ å¾®ä¿¡æ¨é€åŠŸèƒ½

#### é€‰é¡¹B: é’‰é’‰æœºå™¨äºº

1. åˆ›å»ºé’‰é’‰ç¾¤æœºå™¨äºº
2. è·å–Webhookåœ°å€
3. ä½¿ç”¨HTTP POSTå‘é€é€šçŸ¥

---

## ğŸ§ª è¯Šæ–­å·¥å…·

### å·¥å…·1: è¯¦ç»†SMTPè°ƒè¯•

æµ‹è¯•ä¸åŒè¶…æ—¶æ—¶é—´ä¸‹çš„è¿æ¥æƒ…å†µï¼š

```powershell
.\.venv\Scripts\python.exe src\notification\test_smtp_debug.py
```

è¿™ä¼šæµ‹è¯• 10ç§’ã€30ç§’ã€60ç§’ã€120ç§’ è¶…æ—¶ï¼Œæ‰¾å‡ºæœ€ä½³é…ç½®ã€‚

### å·¥å…·2: ç½‘ç»œè´¨é‡ç›‘æ§

```powershell
# æŒç»­ç›‘æ§Gmailè¿æ¥ï¼ˆè¿è¡Œ100æ¬¡pingï¼‰
ping smtp.gmail.com -n 100 > gmail_network_test.txt

# åˆ†æç»“æœ
Get-Content gmail_network_test.txt | Select-String "æ—¶é—´|time"
```

### å·¥å…·3: æŸ¥çœ‹ç­–ç•¥ç»“æœï¼ˆä¸ä¾èµ–é‚®ä»¶ï¼‰

```powershell
# æŸ¥çœ‹æœ€æ–°ä¿¡å·
Get-Content backtest_results\daily\signals_daily.csv | Select-Object -Last 5

# æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—
Get-Content STRATEGY_EXECUTION_LOG.md | Select-Object -Last 50

# æŸ¥çœ‹å›æµ‹æ€»ç»“
Get-Content backtest_results\daily\summary_daily.txt
```

---

## ğŸ“Š å½“å‰ç³»ç»ŸçŠ¶æ€

### âœ… æ­£å¸¸è¿è¡Œçš„éƒ¨åˆ†
- ç­–ç•¥è®¡ç®—é€»è¾‘ âœ…
- æ•°æ®æ›´æ–°æœºåˆ¶ âœ…  
- ä¿¡å·ç”Ÿæˆç®—æ³• âœ…
- å›æµ‹åŠŸèƒ½ âœ…
- æ—¥å¿—è®°å½• âœ…
- æœ¬åœ°æ–‡ä»¶è¾“å‡º âœ…
- é‚®ä»¶é…ç½® âœ…
- é‚®ä»¶ä»£ç  âœ…

### âŒ å­˜åœ¨é—®é¢˜çš„éƒ¨åˆ†
- Gmail SMTPç½‘ç»œè¿æ¥ âŒ (é—´æ­‡æ€§è¶…æ—¶)

### ğŸ”§ å·²ä¼˜åŒ–çš„éƒ¨åˆ†
- è¶…æ—¶æ—¶é—´: 5ç§’ â†’ 60ç§’ âœ…
- é‡è¯•æœºåˆ¶: æ—  â†’ 3æ¬¡é‡è¯• âœ…
- é”™è¯¯å¤„ç†: åŸºç¡€ â†’ è¯¦ç»†åˆ†ç±» âœ…

---

## ğŸ“ ä¸´æ—¶è§£å†³æ–¹æ¡ˆ

åœ¨é‚®ä»¶é—®é¢˜å½»åº•è§£å†³å‰ï¼Œä½ å¯ä»¥ï¼š

### æ–¹æ¡ˆA: æ‰‹åŠ¨æ£€æŸ¥ç­–ç•¥ç»“æœ

æ¯å¤©è¿è¡Œå®Œç­–ç•¥åæŸ¥çœ‹æ–‡ä»¶ï¼š

```powershell
# 1. æŸ¥çœ‹æ˜¯å¦æœ‰æ–°ä¿¡å·
notepad backtest_results\daily\signals_daily.csv

# 2. æŸ¥çœ‹ç­–ç•¥æ€»ç»“
notepad backtest_results\daily\summary_daily.txt

# 3. æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—
notepad STRATEGY_EXECUTION_LOG.md
```

### æ–¹æ¡ˆB: åˆ›å»ºæœ¬åœ°æé†’

```powershell
# åˆ›å»º show_latest_signal.ps1
$signals = Get-Content "backtest_results\daily\signals_daily.csv" | Select-Object -Last 5
$signals | Out-String | Write-Host -ForegroundColor Green

# æ˜¾ç¤ºå¼¹çª—
Add-Type -AssemblyName PresentationFramework
[System.Windows.MessageBox]::Show($signals, "ç­–ç•¥ä¿¡å·", "OK", "Information")
```

### æ–¹æ¡ˆC: ç¦ç”¨é‚®ä»¶åŠŸèƒ½

å¦‚æœé‚®ä»¶å¤±è´¥å½±å“å…¶ä»–åŠŸèƒ½ï¼Œå¯ä»¥ä¸´æ—¶ç¦ç”¨ï¼š

åœ¨ `src/notification/email_config.py` ä¸­ï¼š
```python
enabled: bool = False  # æ”¹ä¸º False
```

---

## ğŸ¯ æ¨èè¡ŒåŠ¨è®¡åˆ’

### ç«‹å³æ‰§è¡Œï¼ˆ5åˆ†é’Ÿï¼‰

1. **è¿è¡ŒSMTPè¯Šæ–­å·¥å…·**:
   ```powershell
   .\.venv\Scripts\python.exe src\notification\test_smtp_debug.py
   ```
   
2. **è®°å½•æµ‹è¯•ç»“æœ**ï¼Œç¡®å®šæœ€ä½³è¶…æ—¶æ—¶é—´

### çŸ­æœŸè§£å†³ï¼ˆ1å°æ—¶å†…ï¼‰

**é€‰æ‹©æ–¹æ¡ˆ1A: æ”¹ç”¨QQé‚®ç®±**

1. å¼€é€šQQé‚®ç®±SMTPï¼ˆ5åˆ†é’Ÿï¼‰
2. ä¿®æ”¹email_config.pyï¼ˆ2åˆ†é’Ÿï¼‰
3. æµ‹è¯•æ–°é…ç½®ï¼ˆ5åˆ†é’Ÿï¼‰
4. è¿è¡Œå®Œæ•´ç­–ç•¥æ£€æŸ¥ï¼ˆ10åˆ†é’Ÿï¼‰

è¿™æ˜¯**æœ€å¿«æœ€ç¨³å®š**çš„æ–¹æ¡ˆï¼

### é•¿æœŸä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

1. é…ç½®å¤šä¸ªé€šçŸ¥æ¸ é“ï¼ˆé‚®ä»¶+å¾®ä¿¡+é’‰é’‰ï¼‰
2. ç›‘æ§ç½‘ç»œè´¨é‡ï¼Œè‡ªåŠ¨é€‰æ‹©æœ€ä½³æ—¶æ®µ
3. æ­å»ºæœ¬åœ°SMTPä¸­è½¬æœåŠ¡å™¨

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœä½ å†³å®šï¼š

1. **æ¢ç”¨QQé‚®ç®±**: å‘Šè¯‰æˆ‘ä½ çš„QQé‚®ç®±ï¼Œæˆ‘å¸®ä½ ä¿®æ”¹é…ç½®
2. **ç»§ç»­æ’æŸ¥Gmail**: è¿è¡Œ `test_smtp_debug.py` å¹¶æŠŠç»“æœå‘ç»™æˆ‘
3. **ä½¿ç”¨å…¶ä»–é€šçŸ¥æ–¹å¼**: å‘Šè¯‰æˆ‘ä½ æƒ³ç”¨çš„æ–¹å¼ï¼ˆå¾®ä¿¡/é’‰é’‰/å…¶ä»–ï¼‰

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- `EMAIL_NETWORK_TROUBLESHOOTING.md` - ç½‘ç»œé—®é¢˜è¯¦ç»†æ’æŸ¥
- `GMAIL_SETUP_GUIDE.md` - Gmailé…ç½®æŒ‡å—
- `test_smtp_debug.py` - SMTPè¯¦ç»†è¯Šæ–­å·¥å…·
- `test_email_system.py` - é‚®ä»¶ç³»ç»Ÿå®Œæ•´æµ‹è¯•

---

**æ›´æ–°æ—¶é—´**: 2025-11-14 21:50  
**é—®é¢˜çŠ¶æ€**: ğŸ” ç½‘ç»œåŸå› å·²ç¡®è®¤ï¼Œç­‰å¾…é€‰æ‹©è§£å†³æ–¹æ¡ˆ  
**å»ºè®®æ–¹æ¡ˆ**: â­ æ”¹ç”¨QQé‚®ç®±ï¼ˆæœ€å¿«æœ€ç¨³å®šï¼‰
